<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-usage/Azure/components" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">SRA Components Breakdown | SRA</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://databricks.github.io/terraform-databricks-sra/docs/usage/Azure/components/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SRA Components Breakdown | SRA"><meta data-rh="true" name="description" content="This section outlines the core components of the Security Reference Architeture (SRA). Several .tf scripts contain direct links to the Databricks Terraform documention."><meta data-rh="true" property="og:description" content="This section outlines the core components of the Security Reference Architeture (SRA). Several .tf scripts contain direct links to the Databricks Terraform documention."><link data-rh="true" rel="icon" href="/terraform-databricks-sra/terraform-databricks-sra/docs/sra/src/img/primary-icon-orange-cloud-security-3291x3220-fa69bde.png"><link data-rh="true" rel="canonical" href="https://databricks.github.io/terraform-databricks-sra/docs/usage/Azure/components/"><link data-rh="true" rel="alternate" href="https://databricks.github.io/terraform-databricks-sra/docs/usage/Azure/components/" hreflang="en"><link data-rh="true" rel="alternate" href="https://databricks.github.io/terraform-databricks-sra/docs/usage/Azure/components/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Usage","item":"https://databricks.github.io/terraform-databricks-sra/docs/usage/"},{"@type":"ListItem","position":2,"name":"Azure","item":"https://databricks.github.io/terraform-databricks-sra/docs/usage/Azure/"},{"@type":"ListItem","position":3,"name":"SRA Components Breakdown","item":"https://databricks.github.io/terraform-databricks-sra/docs/usage/Azure/components"}]}</script><link rel="stylesheet" href="/terraform-databricks-sra/assets/css/styles.affb8d4a.css">
<script src="/terraform-databricks-sra/assets/js/runtime~main.e3bb6376.js" defer="defer"></script>
<script src="/terraform-databricks-sra/assets/js/main.12d71468.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/terraform-databricks-sra/img/primary-icon-orange-cloud-security.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/terraform-databricks-sra/"><div class="navbar__logo"><img src="/terraform-databricks-sra/img/primary-icon-orange-cloud-security.svg" alt="SRA Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/terraform-databricks-sra/img/primary-icon-orange-cloud-security.svg" alt="SRA Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Security Reference Architecture (SRA)</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div><a href="https://github.com/databricks/terraform-databricks-sra" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/terraform-databricks-sra/docs/overview/"><span title="Overview" class="linkLabel_WmDU">Overview</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/terraform-databricks-sra/docs/usage/"><span title="Usage" class="categoryLinkLabel_W154">Usage</span></a><button aria-label="Collapse sidebar category &#x27;Usage&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/terraform-databricks-sra/docs/usage/AWS/"><span title="AWS" class="categoryLinkLabel_W154">AWS</span></a><button aria-label="Expand sidebar category &#x27;AWS&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/terraform-databricks-sra/docs/usage/Azure/"><span title="Azure" class="categoryLinkLabel_W154">Azure</span></a><button aria-label="Collapse sidebar category &#x27;Azure&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/terraform-databricks-sra/docs/usage/Azure/preread/"><span title="Read Before Deploying" class="linkLabel_WmDU">Read Before Deploying</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/terraform-databricks-sra/docs/usage/Azure/components/"><span title="SRA Components Breakdown" class="linkLabel_WmDU">SRA Components Breakdown</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/terraform-databricks-sra/docs/usage/Azure/gettingstarted/"><span title="Getting Started" class="linkLabel_WmDU">Getting Started</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/terraform-databricks-sra/docs/usage/GCP/"><span title="GCP" class="categoryLinkLabel_W154">GCP</span></a><button aria-label="Expand sidebar category &#x27;GCP&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/terraform-databricks-sra/docs/additionalresources/"><span title="Additional Resources" class="linkLabel_WmDU">Additional Resources</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/terraform-databricks-sra/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/terraform-databricks-sra/docs/usage/"><span>Usage</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/terraform-databricks-sra/docs/usage/Azure/"><span>Azure</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">SRA Components Breakdown</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>SRA Components Breakdown</h1></header>
<p>This section outlines the core components of the <strong>Security Reference Architeture (SRA)</strong>. Several <code>.tf</code> scripts contain direct links to the Databricks Terraform documention.
The full Databricks Terraform Provider Documentation can be found <a href="https://registry.terraform.io/providers/databricks/databricks/latest/docs" target="_blank" rel="noopener noreferrer" class="">here</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="core-azure-components">Core Azure Components<a href="#core-azure-components" class="hash-link" aria-label="Direct link to Core Azure Components" title="Direct link to Core Azure Components" translate="no">​</a></h2>
<ul>
<li class=""><strong>Vnet Injection</strong>: <a href="https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/vnet-inject" target="_blank" rel="noopener noreferrer" class="">Vnet Injection</a> allows Azure Databricks workspaces to be deployed directly into a customer-managed virtual network (VNet), providing control over network configuration to meet organizational security and governance requirements.</li>
<li class=""><strong>Private Endpoints</strong>: Leveraging Azure Private Link, <a href="https://learn.microsoft.com/en-us/azure/private-link/private-endpoint-overview" target="_blank" rel="noopener noreferrer" class="">private endpoints</a> connect the customer’s VNet to Azure services without using public IP addresses, ensuring secure, private communication.</li>
<li class=""><strong>PrivateLink Connectivity</strong>: <a href="https://learn.microsoft.com/en-us/azure/private-link/private-link-overview" target="_blank" rel="noopener noreferrer" class="">Private Link</a> establishes private network paths between the customer’s data plane and the Databricks control plane, preventing traffic from traversing the public internet. This template configures <a href="https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/private-link" target="_blank" rel="noopener noreferrer" class="">Back-End Private Link</a> for communication to the Databricks control plane from classic compute clusters.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="core-databricks-components">Core Databricks Components<a href="#core-databricks-components" class="hash-link" aria-label="Direct link to Core Databricks Components" title="Direct link to Core Databricks Components" translate="no">​</a></h2>
<ul>
<li class=""><strong>Unity Catalog</strong>: <a href="https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/" target="_blank" rel="noopener noreferrer" class="">Unity Catalog</a> is a unified governance solution for data and AI assets such as files, tables, and machine learning models. Unity Catalog enforces fine-grained access controls, centralized policy management, auditing, and lineage tracking—all integrated into the Databricks workflow.</li>
<li class=""><strong>Network Connectivity Configuration</strong>: Serverless network connectivity is managed with <a href="https://learn.microsoft.com/en-us/azure/databricks/security/network/serverless-network-security/#ncc" target="_blank" rel="noopener noreferrer" class="">network connectivity configurations (NCC)</a>, which are account-level regional constructs that are used to manage private endpoints creation and firewall enablement at scale. An NCC is created and attached to the workspace, which contains a list of stable Azure service subnets, which will be used by the serverless compute in that workspace to connect the Azure resource using service endpoints.</li>
<li class=""><strong>Restrictive Network Policy</strong>: <a href="https://learn.microsoft.com/en-us/azure/databricks/security/network/serverless-network-security/network-policies" target="_blank" rel="noopener noreferrer" class="">Network Policies</a> implement egress controls for serverless compute by enforcing a restrictive network policy that permits outbound traffic only to required data buckets.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="adding-additional-spokes">Adding Additional Spokes<a href="#adding-additional-spokes" class="hash-link" aria-label="Direct link to Adding Additional Spokes" title="Direct link to Adding Additional Spokes" translate="no">​</a></h2>
<p>To add additional spokes to this configuration, follow the steps below.</p>
<ol>
<li class=""><strong>Add a New Key to the <code>spoke config</code> Variable</strong></li>
</ol>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># Terraform variables (for example, terraform.tfvars)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">spoke_config = {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  spoke = {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    resource_suffix = &quot;spoke&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    cidr            = &quot;10.1.0.0/20&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    tags = {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      environment = &quot;dev&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  spoke_b = { # &lt;----- Add a new spoke config</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    resource_suffix = &quot;spoke_b&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    cidr            = &quot;10.2.0.0/20&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    tags = {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      environment = &quot;test&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<ol start="2">
<li class=""><strong>Add a New Provider in <code>providers.tf</code> for the New Spoke</strong></li>
</ol>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># providers.tf</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># New spoke provider</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">provider &quot;databricks&quot; {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  alias = &quot;spoke_b&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  host  = module.spoke_b.workspace_url</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<ol start="3">
<li class=""><strong>Copy the <code>spoke.tf</code> File</strong>: Copy <code>spoke.tf</code> to a new file (for example, <code>spoke_b.tf</code>).</li>
<li class=""><strong>Modify the Module Names and References</strong>:</li>
</ol>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># spoke_b.tf</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module &quot;spoke_b&quot; { # &lt;----- Modify the name of the module to something unique</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  source = &quot;./modules/spoke&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  # Update these per spoke</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  resource_suffix = var.spoke_config[&quot;spoke_b&quot;].resource_suffix</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  vnet_cidr       = var.spoke_config[&quot;spoke_b&quot;].cidr</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  tags            = var.spoke_config[&quot;spoke_b&quot;].tags</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  depends_on = [module.hub]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module &quot;spoke_b_catalog&quot; {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  source = &quot;./modules/catalog&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  # Update these per catalog for the catalog&#x27;s spoke</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  catalog_name        = module.spoke_b.resource_suffix</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  dns_zone_ids        = [module.spoke_b.dns_zone_ids[&quot;dfs&quot;]]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  ncc_id              = module.spoke_b.ncc_id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  resource_group_name = module.spoke_b.resource_group_name</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  resource_suffix     = module.spoke_b.resource_suffix</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  subnet_id           = module.spoke_b.subnet_ids.privatelink</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  tags                = module.spoke_b.tags</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  providers = {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    databricks.workspace = databricks.spoke_b</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<ol start="5">
<li class=""><strong>Apply the Configuration</strong>: <code>terraform apply</code>.</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="security-analysis-tool-sat">Security Analysis Tool (SAT)<a href="#security-analysis-tool-sat" class="hash-link" aria-label="Direct link to Security Analysis Tool (SAT)" title="Direct link to Security Analysis Tool (SAT)" translate="no">​</a></h2>
<p>The <a href="https://databricks-industry-solutions.github.io/security-analysis-tool/" target="_blank" rel="noopener noreferrer" class="">Security Analysis Tool (SAT)</a> is enabled by default to continuously monitor the security posture of your Databricks environment. By default, SAT is installed in the <strong>hub</strong> workspace, also known as the <code>WEB_AUTH</code> workspace.</p>
<h1>Changing the SAT Workspace</h1>
<p>To deploy the <strong>Security Analysis Tool (SAT)</strong> in a different workspace, three modifications are required in <code>customizations.tf</code>:</p>
<ol>
<li class=""><strong>Update the Databricks provider in the SAT module</strong>:</li>
</ol>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># Default</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">providers = {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> databricks = databricks.hub</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># Modified</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">providers = {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> databricks = databricks.spoke</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<ol start="2">
<li class=""><strong>Update the local sat_workspace reference</strong>:</li>
</ol>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># Default</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">locals {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> sat_workspace = module.hub</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># Modified</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">locals {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> sat_workspace = module.spoke</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<ol start="3">
<li class=""><strong>Update the <code>databricks_permission_assignment.sat_workspace_admin</code> resource</strong></li>
</ol>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># Default</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">resource &quot;databricks_permission_assignment&quot; &quot;sat_workspace_admin&quot; {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> count    = length(module.sat)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> provider = databricks.hub</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># Modified</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">resource &quot;databricks_permission_assignment&quot; &quot;sat_workspace_admin&quot; {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> count    = length(module.sat)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> provider = databricks.spoke</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>NOTE</strong>: The <strong>Security Analysis Tool (SAT)</strong> is designed to be deployed <strong>once per Azure subscription</strong>. To deploy SAT in multiple regions, provision SAT in multiple spokes using the same modifications above.</p>
</blockquote>
<h1>SAT Service Principal</h1>
<p>Some users may not have permissions to create Entra ID service principals. In this case, a pre-existing service principal can be used:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># example.tfvars</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sat_service_principal = {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  client_id     = &quot;00000000-0000-0000-0000-000000000000&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  client_secret = &quot;some-secret&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>If no service principal is provided, the template creates one named spSAT by default. The name can be customized:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># example.tfvars</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sat_service_principal = {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  name = &quot;spSATDev&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<h1>SAT Compute</h1>
<p>The <strong>Security Analysis Tool (SAT)</strong> is installed using classic compute by default. This is because SAT does not yet support inspecting workspaces outside of the current workspace when running on serverless. If you would like to run on serverless compute instead, you can modify the sat_configuration variable to specify using serverless (see below):</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sat_configuration = {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  run_on_serverless = true</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>NOTE</strong>: When running the <strong>Security Analysis Tool (SAT)</strong> on serverless compute, SAT will only inspect the current workspace.</p>
</blockquote></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/terraform-databricks-sra/docs/usage/Azure/preread/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Read Before Deploying</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/terraform-databricks-sra/docs/usage/Azure/gettingstarted/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Getting Started</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#core-azure-components" class="table-of-contents__link toc-highlight">Core Azure Components</a></li><li><a href="#core-databricks-components" class="table-of-contents__link toc-highlight">Core Databricks Components</a></li><li><a href="#adding-additional-spokes" class="table-of-contents__link toc-highlight">Adding Additional Spokes</a></li><li><a href="#security-analysis-tool-sat" class="table-of-contents__link toc-highlight">Security Analysis Tool (SAT)</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Databricks, Inc. Docs built with Docusaurus.</div></div></div></footer></div>
</body>
</html>