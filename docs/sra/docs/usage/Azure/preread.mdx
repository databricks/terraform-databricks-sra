---
sidebar_position: 1
---
import useBaseUrl from '@docusaurus/useBaseUrl';
import Admonition from '@theme/Admonition';

# Read Before Deploying

## Key Considerations
The **Security Reference Architecture (SRA)** is a purpose-built, simplified deployment pattern designed for highly secure and regulated customers.

This architecture includes specific functionalities that may affect certain use cases, as outlined below.

* **Azure Firewall**: [Azure Firewall](https://learn.microsoft.com/en-us/azure/firewall/overview) is deployed to securely manage and control outbound traffic from the classic compute plane. It provides centralized logging, monitoring, and policy enforcement while maintaining compliance with organizational security standards.
    * To add packages to classic compute or serverless compute, set up a private repository for scanned packages or update firewall rules/network policies to specified domains.

* **Hub-and-Spoke Network Topology**: The architecture employs a hub-and-spoke model:
    * The **hub** VNet contains shared infrastructure and services.
    * Each **spoke** Vnet houses isolated Azure Databricks workspaces for different business units or teams.

    This topology enhances security by isolating workloads and controlling traffic flow between VNets.

* **Private Connectivity**: Azure Databricks workspaces are deployed with VNet injection and Private Link, ensuring that all traffic between the workspace and Azure services remains within the Azure backbone network. Private endpoints are configured for services like Azure Storage, Event Hubs, and SQL Databases to prevent data exfiltration.

* **Isolated Unity Catalog Securables**: Unity Catalog securables like catalogs, Storage Credentials, and External Locations are isolated to individual workspaces.
    * To share securables between workspaces, update the resources using the `databricks_workspace_binding` resource.

* **Security Analysis Tool (SAT)**: The [Security Analysis Tool (SAT)](https://databricks-industry-solutions.github.io/security-analysis-tool/) is **disabled by default** to support highly restricted no-egress deployments.
    * When enabled, SAT is installed in the **hub** (webauth) workspace by default.
    * SAT can be enabled by setting `sat_configuration.enabled = true` in your configuration.
    * Requires specific network egress rules (see [Network Egress Control](#network-egress-control) below).
    * See the [Components](./components.mdx#security-analysis-tool-sat) page for detailed configuration options.

## Network Egress Control

By default, SRA implements a **zero-trust network egress policy** where workspaces have **no internet access** from classic or serverless compute. This prevents data exfiltration and ensures compliance with strict security requirements.

### Allowing Internet Access

To enable access to specific FQDNs for package installation or external services, you must explicitly configure network egress rules.

**For spoke workspace (classic and serverless), and hub classic:**
```hcl
allowed_fqdns = [
  "pypi.org",
  "*.pypi.org",
  "pythonhosted.org",
  "*.pythonhosted.org"
]
```

**For hub workspace serverless (used for SAT):**
```hcl
hub_allowed_urls = [
  "pypi.org",
  "pythonhosted.org"  # No wildcards supported
]
```

### SAT URL Requirements

If enabling SAT, you must include SAT-required URLs in your configuration.

**For SAT on classic compute:**
```hcl
allowed_fqdns = [
  "management.azure.com",
  "login.microsoftonline.com",
  "python.org",
  "*.python.org",
  "pypi.org",
  "*.pypi.org",
  "pythonhosted.org",
  "*.pythonhosted.org"
]
```

**For SAT on serverless compute:**
```hcl
hub_allowed_urls = [
  "management.azure.com",
  "login.microsoftonline.com",
  "python.org",
  "pypi.org",
  "pythonhosted.org"
]
```

For complete configuration details, see [Network Egress Configuration](./configuration.mdx#network-egress).
